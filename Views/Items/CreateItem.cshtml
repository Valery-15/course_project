@model CollectionsApp.ViewModels.CreateItemViewModel

<div class="form-group">
    <h1 class="h2 text-primary">Create item for collection "@ViewBag.collection.Title"</h1>

    <form method="post" asp-controller="Items" asp-action="CreateItem" asp-route-collectionId="@ViewBag.collection.Id">
        <div asp-validation-summary="All"></div>

        <div>
            <label asp-for="Title"></label><br />
            <input asp-for="Title" />
            <br /><br />
        </div>

        <div>
            <label>Tags</label><br />
            @for (int i = 0; i < 3; i++)
            {
                <div>
                    <label>#</label>
                    <input type="text" name="tags[@i]" style="width: 8rem" class="typeahead tt-query" autocomplete="off" spellcheck="false"/ >
                </div>
                <br />
            }
            <br />
        </div>

        @{
            int index = 0;
        }
        @foreach (var field in Model.ItemFields)
        {
            <input type="hidden" name="itemFields[@index].Title" value="@field.Title" />
            <input type="hidden" name="itemFields[@index].InputType" value="@field.InputType" />
            @if (field.InputType.Equals("checkbox"))
            {
                <input type="checkbox" name="itemFields[@index].Value" id="@field.Title" />
                <label for="@field.Title">@field.Title</label><br />
            }
            else
            {
                <label for="@field.Title">@field.Title</label><br />
                @if (field.InputType.Equals("textarea"))
                {
                    <textarea name="itemFields[@index].Value" id="@field.Title"></textarea>
                }
                else if (field.InputType.Equals("text"))
                {
                    <input type="text" name="itemFields[@index].Value" id="@field.Title" maxlength="256" />
                }
                else
                {
                    <input type="@field.InputType" name="itemFields[@index].Value" id="@field.Title" />
                }
                <br /><br />
            }
            index++;
        }

        <div>
            <input type="submit" class="btn btn-primary" value="Create" />
        </div>
    </form>
</div>

<script>
    $(document).ready(function () {
        // Constructing the suggestion engine
        var tags = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.whitespace,
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            prefetch: '/Tags/GetTagsList'
        });

        // Initializing the typeahead
        $('.typeahead').typeahead({
            hint: true,
            highlight: true, /* Enable substring highlighting */
            minLength: 1 /* Specify minimum characters required for showing result */
        },
        {
            name: 'tags',
            limit: 5,
            source: tags
        });
    });


</script>

@*@foreach (var field in Model.Fields)
    {
        <div>
            @if (field.InputType.Equals("checkbox"))
            {
                <label for="@field.Title">@field.Title</label><br />
                <input type="checkbox" name="@field.Title" id="@field.Title" />
            }
            else
            {
                <label for="@field.Title">@field.Title</label><br />
                @if (field.InputType.Equals("textarea"))
                {
                    <textarea name="@field.Title" id="@field.Title"></textarea>
                }
                else if (field.InputType.Equals("text"))
                {
                    <input type="text" name="@field.Title" id="@field.Title" maxlength="256" />
                }
                else
                {
                    <input type="@field.InputType" name="@field.Title" id="@field.Title" />

                }
            }
            <br /><br />
        </div>
    }*@